module {
  func.func @run_partition(%arg0: !pto.ptr<f32>, %arg1: !pto.ptr<f32>) {
    %c0 = arith.constant 0 : index
    %c1 = arith.constant 1 : index
    %c1_0 = arith.constant 1 : index
    %c1_1 = arith.constant 1 : index
    %c16 = arith.constant 16 : index
    %c1024 = arith.constant 1024 : index
    %c1024_2 = arith.constant 1024 : index
    %c1048576 = arith.constant 1048576 : index
    %c1048576_3 = arith.constant 1048576 : index
    %c1048576_4 = arith.constant 1048576 : index
    %c1024_5 = arith.constant 1024 : index
    %c1_6 = arith.constant 1 : index
    %0 = pto.make_tensor_view %arg0, shape = [%c1_0, %c1_1, %c16, %c1024, %c1024_2] strides = [%c1048576, %c1048576_3, %c1048576_4, %c1024_5, %c1_6] : !pto.tensor_view<1x1x16x1024x1024xf32>
    %c1_7 = arith.constant 1 : index
    %c1_8 = arith.constant 1 : index
    %c16_9 = arith.constant 16 : index
    %c16_10 = arith.constant 16 : index
    %c16_11 = arith.constant 16 : index
    %1 = pto.partition_view %0, offsets = [%c0, %c0, %c0, %c0, %c0], sizes = [%c1_7, %c1_8, %c16_9, %c16_10, %c16_11] : !pto.tensor_view<1x1x16x1024x1024xf32> -> !pto.partition_tensor_view<1x1x16x16x16xf32>
    %2 = pto.alloc_tile : !pto.tile_buf<loc=mat, dtype=f32, rows=256, cols=16, v_row=256, v_col=16, blayout=row_major, slayout=none_box, fractal=512, pad=0>
    pto.tload ins(%1 : !pto.partition_tensor_view<1x1x16x16x16xf32>) outs(%2 : !pto.tile_buf<loc=mat, dtype=f32, rows=256, cols=16, v_row=256, v_col=16, blayout=row_major, slayout=none_box, fractal=512, pad=0>)
    %3 = pto.make_tensor_view %arg1, shape = [%c1_0, %c1_1, %c16, %c1024, %c1024_2] strides = [%c1048576, %c1048576_3, %c1048576_4, %c1024_5, %c1_6] : !pto.tensor_view<1x1x16x1024x1024xf32>
    %c1_12 = arith.constant 1 : index
    %c1_13 = arith.constant 1 : index
    %c16_14 = arith.constant 16 : index
    %c16_15 = arith.constant 16 : index
    %c16_16 = arith.constant 16 : index
    %4 = pto.partition_view %3, offsets = [%c0, %c0, %c0, %c0, %c0], sizes = [%c1_12, %c1_13, %c16_14, %c16_15, %c16_16] : !pto.tensor_view<1x1x16x1024x1024xf32> -> !pto.partition_tensor_view<1x1x16x16x16xf32>
    pto.tstore ins(%2 : !pto.tile_buf<loc=mat, dtype=f32, rows=256, cols=16, v_row=256, v_col=16, blayout=row_major, slayout=none_box, fractal=512, pad=0>) outs(%4 : !pto.partition_tensor_view<1x1x16x16x16xf32>)
    return
  }
}

