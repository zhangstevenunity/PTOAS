#include <pto/pto-inst.hpp>
#include <pto/common/constants.hpp>
#include "acl/acl.h"

#include "pto/pto-inst.hpp"
using namespace pto;
__global__ AICORE void gqa_attention_block(__gm__ float* v1, __gm__ float* v2, __gm__ float* v3, __gm__ float* v4, __gm__ float* v5, __gm__ float* v6, __gm__ float* v7) {
  unsigned v8 = 1;
  unsigned v9 = 0;
  float v10 = 0.0416666716f;
  float v11 = 0.166666701f;
  float v12 = 0.5f;
  float v13 = 32.0000992f;
  float v14 = 1.00010002f;
  float v15 = 4.00010014f;
  float v16 = -4.00010014f;
  float v17 = 0.176776707f;
  int32_t v18 = 32;
  int32_t v19 = 1;
  int64_t v20 = 0;
  int64_t v21 = 4096;
  int64_t v22 = 8192;
  int64_t v23 = 20480;
  int64_t v24 = 12288;
  int64_t v25 = 16384;
  using T = float;
  unsigned v26 = (unsigned) v18;
  unsigned v27 = v9 * v26;
  unsigned v28 = v9 + v27;
  unsigned v29 = (unsigned) v19;
  unsigned v30 = v9 * v29;
  unsigned v31 = v28 + v30;
  __gm__ float* v32 = v1 + v31;
  using GTShape_175477776 = pto::Shape<1, 1, 1, 32, 32>;
  using GTStride_175477776 = pto::Stride<1024, 1024, 1024, 32, 1>;
  constexpr pto::Layout GT_175477776_layout = pto::Layout::ND;
  GTShape_175477776 v33 = GTShape_175477776();
  GTStride_175477776 v34 = GTStride_175477776();
  using GT_175477776 = GlobalTensor<float, GTShape_175477776, GTStride_175477776, GT_175477776_layout>;
  GT_175477776 v35 = GT_175477776(v32, v33, v34);
  unsigned v36 = (unsigned) v18;
  unsigned v37 = v9 * v36;
  unsigned v38 = v9 + v37;
  unsigned v39 = (unsigned) v19;
  unsigned v40 = v9 * v39;
  unsigned v41 = v38 + v40;
  __gm__ float* v42 = v2 + v41;
  using GTShape_175129472 = pto::Shape<1, 1, 1, 32, 32>;
  using GTStride_175129472 = pto::Stride<1024, 1024, 1024, 32, 1>;
  constexpr pto::Layout GT_175129472_layout = pto::Layout::ND;
  GTShape_175129472 v43 = GTShape_175129472();
  GTStride_175129472 v44 = GTStride_175129472();
  using GT_175129472 = GlobalTensor<float, GTShape_175129472, GTStride_175129472, GT_175129472_layout>;
  GT_175129472 v45 = GT_175129472(v42, v43, v44);
  unsigned v46 = (unsigned) v18;
  unsigned v47 = v9 * v46;
  unsigned v48 = v9 + v47;
  unsigned v49 = (unsigned) v19;
  unsigned v50 = v9 * v49;
  unsigned v51 = v48 + v50;
  __gm__ float* v52 = v3 + v51;
  using GTShape_175129856 = pto::Shape<1, 1, 1, 32, 32>;
  using GTStride_175129856 = pto::Stride<1024, 1024, 1024, 32, 1>;
  constexpr pto::Layout GT_175129856_layout = pto::Layout::ND;
  GTShape_175129856 v53 = GTShape_175129856();
  GTStride_175129856 v54 = GTStride_175129856();
  using GT_175129856 = GlobalTensor<float, GTShape_175129856, GTStride_175129856, GT_175129856_layout>;
  GT_175129856 v55 = GT_175129856(v52, v53, v54);
  unsigned v56 = (unsigned) v18;
  unsigned v57 = v9 * v56;
  unsigned v58 = v9 + v57;
  unsigned v59 = (unsigned) v19;
  unsigned v60 = v9 * v59;
  unsigned v61 = v58 + v60;
  __gm__ float* v62 = v4 + v61;
  using GTShape_175130240 = pto::Shape<1, 1, 1, 32, 32>;
  using GTStride_175130240 = pto::Stride<1024, 1024, 1024, 32, 1>;
  constexpr pto::Layout GT_175130240_layout = pto::Layout::ND;
  GTShape_175130240 v63 = GTShape_175130240();
  GTStride_175130240 v64 = GTStride_175130240();
  using GT_175130240 = GlobalTensor<float, GTShape_175130240, GTStride_175130240, GT_175130240_layout>;
  GT_175130240 v65 = GT_175130240(v62, v63, v64);
  unsigned v66 = (unsigned) v18;
  unsigned v67 = v9 * v66;
  unsigned v68 = v9 + v67;
  unsigned v69 = (unsigned) v19;
  unsigned v70 = v9 * v69;
  unsigned v71 = v68 + v70;
  __gm__ float* v72 = v5 + v71;
  using GTShape_175130624 = pto::Shape<1, 1, 1, 32, 32>;
  using GTStride_175130624 = pto::Stride<1024, 1024, 1024, 32, 1>;
  constexpr pto::Layout GT_175130624_layout = pto::Layout::ND;
  GTShape_175130624 v73 = GTShape_175130624();
  GTStride_175130624 v74 = GTStride_175130624();
  using GT_175130624 = GlobalTensor<float, GTShape_175130624, GTStride_175130624, GT_175130624_layout>;
  GT_175130624 v75 = GT_175130624(v72, v73, v74);
  unsigned v76 = (unsigned) v18;
  unsigned v77 = v9 * v76;
  unsigned v78 = v9 + v77;
  unsigned v79 = (unsigned) v19;
  unsigned v80 = v9 * v79;
  unsigned v81 = v78 + v80;
  __gm__ float* v82 = v6 + v81;
  using GTShape_175131008 = pto::Shape<1, 1, 1, 32, 32>;
  using GTStride_175131008 = pto::Stride<1024, 1024, 1024, 32, 1>;
  constexpr pto::Layout GT_175131008_layout = pto::Layout::ND;
  GTShape_175131008 v83 = GTShape_175131008();
  GTStride_175131008 v84 = GTStride_175131008();
  using GT_175131008 = GlobalTensor<float, GTShape_175131008, GTStride_175131008, GT_175131008_layout>;
  GT_175131008 v85 = GT_175131008(v82, v83, v84);
  unsigned v86 = (unsigned) v18;
  unsigned v87 = v9 * v86;
  unsigned v88 = v9 + v87;
  unsigned v89 = (unsigned) v19;
  unsigned v90 = v9 * v89;
  unsigned v91 = v88 + v90;
  __gm__ float* v92 = v7 + v91;
  using GTShape_175131392 = pto::Shape<1, 1, 1, 32, 32>;
  using GTStride_175131392 = pto::Stride<1024, 1024, 1024, 32, 1>;
  constexpr pto::Layout GT_175131392_layout = pto::Layout::ND;
  GTShape_175131392 v93 = GTShape_175131392();
  GTStride_175131392 v94 = GTStride_175131392();
  using GT_175131392 = GlobalTensor<float, GTShape_175131392, GTStride_175131392, GT_175131392_layout>;
  GT_175131392 v95 = GT_175131392(v92, v93, v94);
  Tile<TileType::Mat, float, 32, 32, BLayout::ColMajor, 32, 32, SLayout::RowMajor, 512, PadValue::Null> v96;
  TASSIGN(v96, v20);
  Tile<TileType::Mat, float, 32, 32, BLayout::ColMajor, 32, 32, SLayout::RowMajor, 512, PadValue::Null> v97;
  TASSIGN(v97, v21);
  Tile<TileType::Mat, float, 32, 32, BLayout::ColMajor, 32, 32, SLayout::RowMajor, 512, PadValue::Null> v98;
  TASSIGN(v98, v22);
  Tile<TileType::Left, float, 32, 32, BLayout::RowMajor, 32, 32, SLayout::RowMajor, 512, PadValue::Null> v99;
  TASSIGN(v99, v20);
  Tile<TileType::Right, float, 32, 32, BLayout::RowMajor, 32, 32, SLayout::ColMajor, 512, PadValue::Null> v100;
  TASSIGN(v100, v20);
  Tile<TileType::Right, float, 32, 32, BLayout::RowMajor, 32, 32, SLayout::ColMajor, 512, PadValue::Null> v101;
  TASSIGN(v101, v21);
  Tile<TileType::Acc, float, 32, 32, BLayout::ColMajor, 32, 32, SLayout::RowMajor, 1024, PadValue::Null> v102;
  TASSIGN(v102, v20);
  Tile<TileType::Acc, float, 32, 32, BLayout::ColMajor, 32, 32, SLayout::RowMajor, 1024, PadValue::Null> v103;
  TASSIGN(v103, v21);
  Tile<TileType::Vec, float, 32, 32, BLayout::RowMajor, 32, 32, SLayout::NoneBox, 512, PadValue::Null> v104;
  TASSIGN(v104, v20);
  Tile<TileType::Vec, float, 32, 32, BLayout::RowMajor, 32, 32, SLayout::NoneBox, 512, PadValue::Null> v105;
  TASSIGN(v105, v21);
  Tile<TileType::Vec, float, 32, 32, BLayout::RowMajor, 32, 32, SLayout::NoneBox, 512, PadValue::Null> v106;
  TASSIGN(v106, v23);
  Tile<TileType::Vec, float, 32, 32, BLayout::RowMajor, 32, 32, SLayout::NoneBox, 512, PadValue::Null> v107;
  TASSIGN(v107, v22);
  Tile<TileType::Vec, float, 32, 32, BLayout::RowMajor, 32, 32, SLayout::NoneBox, 512, PadValue::Null> v108;
  TASSIGN(v108, v24);
  Tile<TileType::Vec, float, 32, 32, BLayout::RowMajor, 32, 32, SLayout::NoneBox, 512, PadValue::Null> v109;
  TASSIGN(v109, v25);
  Tile<TileType::Mat, float, 32, 32, BLayout::ColMajor, 32, 32, SLayout::RowMajor, 512, PadValue::Null> v110;
  TASSIGN(v110, v24);
  Tile<TileType::Left, float, 32, 32, BLayout::RowMajor, 32, 32, SLayout::RowMajor, 512, PadValue::Null> v111;
  TASSIGN(v111, v21);
  TLOAD(v96, v35);
  set_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID0);
  TLOAD(v97, v45);
  set_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID1);
  TLOAD(v98, v55);
  set_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID2);
  wait_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID0);
  TMOV(v99, v96);
  wait_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID1);
  TMOV(v100, v97);
  set_flag(PIPE_MTE1, PIPE_M, EVENT_ID0);
  wait_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID2);
  TMOV(v101, v98);
  wait_flag(PIPE_MTE1, PIPE_M, EVENT_ID0);
  TMATMUL(v102, v99, v100);
  set_flag(PIPE_M, PIPE_MTE3, EVENT_ID0);
  wait_flag(PIPE_M, PIPE_MTE3, EVENT_ID0);
  TSTORE(v75, v102);
  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID0);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID0);
  TLOAD(v104, v75);
  set_flag(PIPE_MTE2, PIPE_V, EVENT_ID0);
  TLOAD(v105, v65);
  TMUL(v104, v104, v105);
  TMULS(v104, v104, v17);
  TMAXS(v104, v104, v16);
  TMINS(v104, v104, v15);
  TMUL(v107, v104, v104);
  TMUL(v108, v107, v104);
  TMUL(v109, v108, v104);
  TMULS(v107, v107, v12);
  TMULS(v108, v108, v11);
  TMULS(v109, v109, v10);
  wait_flag(PIPE_MTE2, PIPE_V, EVENT_ID0);
  TADD(v106, v104, v107);
  TADD(v106, v106, v108);
  TADD(v106, v106, v109);
  set_flag(PIPE_V, PIPE_MTE3, EVENT_ID0);
  TADDS(v106, v106, v14);
  TDIVS(v106, v106, v13);
  wait_flag(PIPE_V, PIPE_MTE3, EVENT_ID0);
  TSTORE(v85, v106);
  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID1);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID1);
  TLOAD(v110, v85);
  set_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID3);
  wait_flag(PIPE_MTE2, PIPE_MTE1, EVENT_ID3);
  TMOV(v111, v110);
  set_flag(PIPE_MTE1, PIPE_M, EVENT_ID1);
  wait_flag(PIPE_MTE1, PIPE_M, EVENT_ID1);
  TMATMUL(v103, v111, v101);
  set_flag(PIPE_M, PIPE_MTE3, EVENT_ID1);
  wait_flag(PIPE_M, PIPE_MTE3, EVENT_ID1);
  TSTORE(v95, v103);
  pipe_barrier(PIPE_ALL);
  return;
}


